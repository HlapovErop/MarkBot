# Dockerfile - это файл, который описывает, как мы собираем наш проект в образ.
# Фактически это рецепт одного блюда (одного контейнера), и если у вас капец сложная система, то файлов может быть несколько.
# На некоторые блюда (например вареное яйцо), рецепт вообще не нужен, а значит не нужен и Dockerfile. Пример тому БД - все и так знают, как его варить


# FROM говорит, какой мы образ используем, в данном слечае официальный от golang с определенной версией.
# Образов пруд пруди, найти их не состовляет сложности,
# тем более собранных докерфайлов на все случаи жизни можно найти с примерами проектов.
# Можете на это смотреть, как на установку гошки на виртуальную машину
FROM golang:1.23.4

# WORKDIR говорит, куда мы будем работать, т.е. куда будем копировать файлы.
# В данном случае мы работаем в папке /usr/src/api, т.е. в папку /usr/src/api (логично? логично)
# Почему эта папка? Контейнеры работают на базе линукс, где в /usr/src находятся исходные тексты программ,
# установленных в системе. app/ - уже кастомная папка, в которой мы будем хранить наши файлы
# (не забывайте, что это все внутри докера, физически на компе храните свой проект где душе угодно)
WORKDIR /usr/src/api

# RUN говорит, что мы будем выполнять команду(после RUN идет bash команда, которую хотите заюзать).
# В данном случае установка air - это гошная приколюха, которая позволяет рекомпилировать проект в рантайме.
# Не нужно ребилдить докер, чтобы увидеть изменения (подробнее читай про live-reloading и не путай с hot-reloading)
RUN go install github.com/air-verse/air@latest

# COPY говорит, какие файлы из проекта или нашего компьютера нужно перенести в контейнер (тк изначально он пустой). Первая точка означает, что мы копируем эту директорию на компютере (где проект и все дела). Вторая точка - куда, в нашем случае в рабочую директорию контейнера - /usr/src/api
COPY . /usr/src/api

# подтягивание зависимостей для гошного проекта
RUN go mod tidy
